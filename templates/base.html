<!DOCTYPE html>
<html lang="en" class="h-full">

<head>
    <meta charset="UTF-8">
    <title>{% block title %}Dashboard{% endblock %}</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- FullCalendar CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body class="bg-background text-primary h-full flex flex-col">
    <!-- Top Nav Bar -->
    <nav class="flex items-center bg-white px-6 py-4 shadow justify-between sticky top-0 z-50 text-lg">
        <!-- Logo / App Name -->
        <div class="flex items-center flex-shrink-0 mr-6">
            <a href="{% if session.get('username') %}{{ url_for('dashboard') }}{% else %}{{ url_for('index') }}{% endif %}"
               class="text-xl font-semibold text-primary hover:text-secondary transition-colors duration-300">
                StudyTracker
            </a>
        </div>
        <!-- Main Nav Links -->
        <div class="flex items-center">
            {% if session.get('username') %}
            <a href="{{ url_for('dashboard') }}"
               class="flex items-center px-4 py-2 rounded-lg mr-2 {% if request.endpoint == 'dashboard' %}bg-indigo-100 text-indigo-600 font-semibold{% else %}text-gray-700 hover:text-indigo-600 hover:bg-indigo-50{% endif %} text-xl">
                <i class="fa-solid fa-gauge mr-3 text-xl"></i> Dashboard
            </a>
            <a href="{{ url_for('study_area') }}"
               class="flex items-center px-4 py-2 rounded-lg mr-2 {% if request.endpoint == 'study_area' %}bg-indigo-100 text-indigo-600 font-semibold{% else %}text-gray-700 hover:text-indigo-600 hover:bg-indigo-50{% endif %} text-xl">
                <i class="fa-solid fa-book-open mr-3 text-xl"></i> Study Area
            </a>
            <a href="{{ url_for('health_carer') }}"
               class="flex items-center px-4 py-2 rounded-lg mr-2 {% if request.endpoint == 'health_carer' %}bg-indigo-100 text-indigo-600 font-semibold{% else %}text-gray-700 hover:text-indigo-600 hover:bg-indigo-50{% endif %} text-xl">
                <i class="fa-solid fa-heart-pulse mr-3 text-xl"></i> Health Carer
            </a>
            <a href="{{ url_for('share_data') }}"
               class="flex items-center px-4 py-2 rounded-lg mr-2 {% if request.endpoint == 'share_data' %}bg-indigo-100 text-indigo-600 font-semibold{% else %}text-gray-700 hover:text-indigo-600 hover:bg-indigo-50{% endif %} text-xl">
                <i class="fa-solid fa-share-nodes mr-3 text-xl"></i> Share Data
            </a>
            <a href="{{ url_for('friends') }}"
               class="flex items-center px-4 py-2 rounded-lg mr-2 {% if request.endpoint == 'friends' %}bg-indigo-100 text-indigo-600 font-semibold{% else %}text-gray-700 hover:text-indigo-600 hover:bg-indigo-50{% endif %} text-xl">
                <i class="fa-solid fa-user-group mr-3 text-xl"></i> Social
            </a>
            {% endif %}
        </div>

        <!-- Auth/User Buttons -->
        {% if not (request.endpoint == 'index' and not session.get('username')) %}
        <div class="flex items-center space-x-4">
            <!-- Dark Mode Toggle -->
            <label for="darkModeToggle" class="flex items-center cursor-pointer">
                <input id="darkModeToggle" type="checkbox" class="sr-only">
                <div class="relative">
                    <div class="block bg-secondary w-10 h-6 rounded-full"></div>
                    <div class="dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transform transition-transform duration-300"></div>
                </div>
                <span class="ml-3 text-primary">Dark Mode</span>
            </label>
            {% if session.get('username') %}
            <!-- Notifications Bell Icon -->
            <a href="{{ url_for('notifications') }}" class="relative flex items-center px-2 py-2">
                <svg class="w-6 h-6 text-gray-400 hover:text-indigo-600 transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                </svg>
                {% if pending_requests_count > 0 %}
                <span class="absolute top-1 right-1 w-2.5 h-2.5 bg-red-500 rounded-full"></span>
                {% endif %}
            </a>
            <div class="relative group inline-block">
                <a href="{{ url_for('profile') }}"
                   class="inline-flex items-center text-primary hover:text-secondary transition-colors duration-300 font-medium">
                    <i class="fa-solid fa-user-circle mr-2"></i>
                    {{ session['username'] }}
                    <svg class="ml-1 w-4 h-4 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                        <path d="M5.516 7.548L10 12l4.484-4.452z" />
                    </svg>
                </a>
                <ul class="absolute hidden right-0 pt-1 group-hover:block bg-white text-primary rounded shadow-lg border border-secondary min-w-[160px] z-50">
                    <li><a href="{{ url_for('profile') }}" class="block px-4 py-2 hover:bg-secondary hover:text-white transition-colors duration-300">Profile</a></li>
                    <li><a href="{{ url_for('logout') }}" class="block px-4 py-2 hover:bg-red-100 text-red-600 hover:text-red-700 transition-colors duration-300">Logout</a></li>
                </ul>
            </div>
            {% else %}
            <a href="{{ url_for('login') }}" class="px-4 py-2 border border-primary text-primary rounded hover:bg-primary hover:text-white transition-colors duration-300">Login</a>
            <a href="{{ url_for('signup') }}" class="px-4 py-2 bg-primary text-white rounded hover:bg-secondary transition-colors duration-300">Sign Up</a>
            {% endif %}
        </div>
        {% endif %}
    </nav>

    <!-- Main Content Here -->
    <main class="flex-1 w-full page-content pt-8">
        {% block content %}
        {% endblock %}
    </main>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>

    {% block scripts %}{% endblock %}
</body>

</html>